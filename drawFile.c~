#include <FPT.h>   

int numpoints[10], numpolys[10];
double x[10][9000], y[10][9000];
int psize[10][5000]; //size of polyogns
int con[10][5000][20]; //rc, row column
double red[10][5000], grn[10][5000], blu[10][5000];

void draw(int k) {
  int i, j;
  for(i = 0; i < numpolys[k]; i++) {
    G_rgb(red[k][i], grn[k][i], blu[k][i]);
    double polyx[9000], polyy[9000];
    for(j = 0; j < psize[k][i]; j++) {
      int point = con[k][i][j];
      polyx[j] = x[k][point];
      polyy[j] = y[k][point];
    }
    G_fill_polygon(polyx, polyy, psize[k][i]);
  }
}

int main(int argc,  char **argv) {

  FILE *q;
  int i, j, k, key;

  G_init_graphics(800,800);

  G_rgb(0,0,0) ;
  G_clear() ;

  for(k = 1; k < argc; k++) {
    q = fopen(argv[k], "r");
    if (q == NULL) {
      printf("can't open file \n");
      exit(0);
    }

    fscanf(q, "%d", &numpoints[k]);
 
    for(i = 0; i < numpoints[k]; i++) {
      fscanf(q, "%lf %lf", &x[k][i], &y[k][i]); //writes to the array
    }

    fscanf(q, "%d", &numpolys[k]);

    for(i = 0; i < numpolys[k]; i++) {
      fscanf(q, "%d", &psize[k][i]);
      for(j = 0; j < psize[k][i]; j++) {
        fscanf(q, "%d", &con[k][i][j]);
      }
    }

    for(i = 0; i < numpolys[k]; i++) {
      fscanf(q, "%lf %lf %lf", &red[k][i], &grn[k][i], &blu[k][i]);
    }
  }

 while (0 == 0) { // this while loop is the problem, i think i dont understand something
    printf("%d \n", key);
    G_clear() ;
    key = G_wait_key();
    if (key == 'x') {break;}
    draw(key);
  }

}
